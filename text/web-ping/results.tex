\section{Analysis}\label{sec:results_web_ping}


\todo{Evan: Blurb}
\subsection{Initial Site Ping Analysis}

The first analyses was conducted live, directly on the site for users to see on the aforementioned D3-powered map view (see \cref{fig:siteping_state_view}). This map allowed us to both come to early conclusions about the data, and allowed participants to be able to see the data in real time. This map is calculated by averaging all of the cities in the state and then using the \iqr to scale the color scheme. 

\begin{figure}
    \centering
    \includegraphics{siteping/Siteping_state_map.png}
    \caption{State view chloropleth map}
    \label{fig:siteping_state_view}
\end{figure}

Data was aggregated server-side by state and city to rank them from best and worst and display the rankings on the site. Every new data point caused an update in the analyses -- both for our own uses and to help users understand how their state performs. An example of these rankings is shown in \cref{fig:siteping_rankings}.

\begin{figure}[h]
    \centering
    \includegraphics{siteping/Sitping_Rankings.png}
    \caption{Site ping live-updating state rankings}
    \label{fig:siteping_rankings}
\end{figure}

\subsection{Data Quality}

The first measure of data quality tried was standard deviation. \Cref{fig:siteping_stdev_dist} shows the per-location distribution of these values, which follow a fairly smooth curve.

\begin{figure}[h]
    \centering
    \includegraphics{siteping/siteping_rtt_stdev_distribution.png}
    \caption{Distribution of site ping standard deviations by location}
    \label{fig:siteping_stdev_dist}
\end{figure}

The overwhelming majority of points have standard deviations of around 150 milliseconds. This is a fairly high standard deviation, most likely caused by the small number of data points for each location.

\begin{figure}[h]
    \centering
    \includegraphics{siteping/siteping_rtt_cv_distribution.png}
    \caption{Distribution of Coefficient of Variations pair by location}
    \label{fig:siteping_cv_dist}
\end{figure}

Next, we calculated the \cv for each location, shown in \cref{fig:siteping_cv_dist}. \CVs are dimensionless measures of the ratio between standard deviation and mean, interpreted the same across any data set. Most of the \cvs are around 1, meaning there is significant variance in the data. Again, this is most likely related to the relatively small number of data points that exist for each location.

\subsubsection{Evaluating State Rankings}

\begin{figure}[h]
    \centering
    \includegraphics{siteping/siteping_clusters_cdf.png}
    \caption{Continuous distribution function of state rankings}
    \label{fig:siteping_cdf}
\end{figure}
To examine whether or not it was statistically allowable to aggregate the data by state, we used the Kruskal-Wallis test, as described in \cref{sec:stats_methods}. From there we grouped the states into cliques based on whether or not they could be compared with all the other states. \Cref{fig:siteping_cdf} shows a \cdf of all of the groupings of states.

\input{text/web-ping/tables/state_rankings} 

\Cref{tab:site_ping_state_rankings} only provides a rough estimate of Internet Connectivity. As expected, the more densely populated areas have better connectivity, like DC and Delaware. More rural areas, like Alaska and Montana have worse connectivity. North Dakota was filtered out with z-score filtering.
\todo{David: add more about the rankings to this section}
\subsection{Results}

\subsubsection{CDNs}
When searching for the small image files we discovered that the vast majority of websites use a \cdn for serving their content, including both JavaScript as well as static content. As such, our ping results are a reflection of a user's connection to each \cdn. To determine if there was a strong correlation between user location and speed to a given \cdn we attempted to determine the \cdn each site was using through \icmp pings and reverse \dns lookups, then mapped the pings for a given \cdn (including pings to all the sites that use that \cdn). We found that the \rtt to a given \cdn tended to be very similar across a given area. \todo{Evan: add map}

\subsubsection{Final Heat Map}
The final heat map produced from the site ping data shows some pretty clear trends. The coastal and central states have significantly lower ping times than the south-eastern states and north-western states. In states with high ping times there are pockets of low ping times around major cities, such as in  Tampa, Jacksonville, Orlando, and Miami, Florida; Knoxville and Memphis, Tennessee; and Colorado Springs, Colorado. There are some areas with surprising, and somewhat dubious results. For example, New York City, New York; Seattle, Washington; and Los Angeles, California all appear to be in pockets of poor \rtt surrounded by good \rtt.

\todo{Evan: do}
The heat map shows many states that are heavily divided by \rtt. This suggests that a more appropriate way of ranking states is with the percentage of each state that has a "good" \rtt.

\begin{figure}[h]
    \centering
    \includegraphics{images/siteping/site_ping_rtt_idw.jpg}
    \caption{Final heat map} % you've been visited by the latex fairy
    \label{fig:siteping_heatmap}
\end{figure}
